htmx.defineExtension("preload",{onEvent:function(name,event){var attr,load,init;"htmx:afterProcessNode"===name&&(attr=function(node,property){if(null!=node)return node.getAttribute(property)||node.getAttribute("data-"+property)||attr(node.parentElement,property)},load=function(node){function done(html){node.preloadAlways||(node.preloadState="DONE"),"true"==attr(node,"preload-images")&&(document.createElement("div").innerHTML=html)}return function(){var hxGet,r;"READY"===node.preloadState&&((hxGet=node.getAttribute("hx-get")||node.getAttribute("data-hx-get"))?htmx.ajax("GET",hxGet,{source:node,handler:function(elt,info){done(info.xhr.responseText)}}):node.getAttribute("href")&&((r=new XMLHttpRequest).open("GET",node.getAttribute("href")),r.onload=function(){done(r.responseText)},r.send()))}},init=function(node){if(node.getAttribute("href")+node.getAttribute("hx-get")+node.getAttribute("data-hx-get")!=""&&void 0===node.preloadState){var on=attr(node,"preload")||"mousedown",always=-1!==on.indexOf("always");switch(always&&(on=on.replace("always","").trim()),node.addEventListener(on,function(evt){"PAUSE"===node.preloadState&&(node.preloadState="READY","mouseover"===on?window.setTimeout(load(node),100):load(node)())}),on){case"mouseover":node.addEventListener("touchstart",load(node)),node.addEventListener("mouseout",function(evt){evt.target===node&&"READY"===node.preloadState&&(node.preloadState="PAUSE")});break;case"mousedown":node.addEventListener("touchstart",load(node))}node.preloadState="PAUSE",node.preloadAlways=always,htmx.trigger(node,"preload:init")}},event.target.querySelectorAll("[preload]").forEach(function(node){init(node),node.querySelectorAll("a,[hx-get],[data-hx-get]").forEach(init)}))}});